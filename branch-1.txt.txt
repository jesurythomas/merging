Changes from branch 2